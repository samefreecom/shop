<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Print Tool</title>
    <script>
        (function (global, factory) {
            typeof exports === 'object' && typeof module !== 'undefined'
                ? module.exports = factory()
                : typeof define === 'function' && define.amd
                ? define(factory) :
                // cf. https://github.com/dankogai/js-base64/issues/119
                (function () {
                    // existing version for noConflict()
                    var _Base64 = global.Base64;
                    var gBase64 = factory();
                    gBase64.noConflict = function () {
                        global.Base64 = _Base64;
                        return gBase64;
                    };
                    if (global.Meteor) { // Meteor.js
                        Base64 = gBase64;
                    }
                    global.Base64 = gBase64;
                })();
        }((typeof self !== 'undefined' ? self
            : typeof window !== 'undefined' ? window
                : typeof global !== 'undefined' ? global
                    : this), function () {
            'use strict';
            /**
             *  base64.ts
             *
             *  Licensed under the BSD 3-Clause License.
             *    http://opensource.org/licenses/BSD-3-Clause
             *
             *  References:
             *    http://en.wikipedia.org/wiki/Base64
             *
             * @author Dan Kogai (https://github.com/dankogai)
             */
            var version = '3.7.5';
            /**
             * @deprecated use lowercase `version`.
             */
            var VERSION = version;
            var _hasatob = typeof atob === 'function';
            var _hasbtoa = typeof btoa === 'function';
            var _hasBuffer = typeof Buffer === 'function';
            var _TD = typeof TextDecoder === 'function' ? new TextDecoder() : undefined;
            var _TE = typeof TextEncoder === 'function' ? new TextEncoder() : undefined;
            var b64ch = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';
            var b64chs = Array.prototype.slice.call(b64ch);
            var b64tab = (function (a) {
                var tab = {};
                a.forEach(function (c, i) { return tab[c] = i; });
                return tab;
            })(b64chs);
            var b64re = /^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/;
            var _fromCC = String.fromCharCode.bind(String);
            var _U8Afrom = typeof Uint8Array.from === 'function'
                ? Uint8Array.from.bind(Uint8Array)
                : function (it) { return new Uint8Array(Array.prototype.slice.call(it, 0)); };
            var _mkUriSafe = function (src) { return src
                .replace(/=/g, '').replace(/[+\/]/g, function (m0) { return m0 == '+' ? '-' : '_'; }); };
            var _tidyB64 = function (s) { return s.replace(/[^A-Za-z0-9\+\/]/g, ''); };
            /**
             * polyfill version of `btoa`
             */
            var btoaPolyfill = function (bin) {
                // console.log('polyfilled');
                var u32, c0, c1, c2, asc = '';
                var pad = bin.length % 3;
                for (var i = 0; i < bin.length;) {
                    if ((c0 = bin.charCodeAt(i++)) > 255 ||
                        (c1 = bin.charCodeAt(i++)) > 255 ||
                        (c2 = bin.charCodeAt(i++)) > 255)
                        throw new TypeError('invalid character found');
                    u32 = (c0 << 16) | (c1 << 8) | c2;
                    asc += b64chs[u32 >> 18 & 63]
                        + b64chs[u32 >> 12 & 63]
                        + b64chs[u32 >> 6 & 63]
                        + b64chs[u32 & 63];
                }
                return pad ? asc.slice(0, pad - 3) + "===".substring(pad) : asc;
            };
            /**
             * does what `window.btoa` of web browsers do.
             * @param {String} bin binary string
             * @returns {string} Base64-encoded string
             */
            var _btoa = _hasbtoa ? function (bin) { return btoa(bin); }
                : _hasBuffer ? function (bin) { return Buffer.from(bin, 'binary').toString('base64'); }
                    : btoaPolyfill;
            var _fromUint8Array = _hasBuffer
                ? function (u8a) { return Buffer.from(u8a).toString('base64'); }
                : function (u8a) {
                    // cf. https://stackoverflow.com/questions/12710001/how-to-convert-uint8-array-to-base64-encoded-string/12713326#12713326
                    var maxargs = 0x1000;
                    var strs = [];
                    for (var i = 0, l = u8a.length; i < l; i += maxargs) {
                        strs.push(_fromCC.apply(null, u8a.subarray(i, i + maxargs)));
                    }
                    return _btoa(strs.join(''));
                };
            /**
             * converts a Uint8Array to a Base64 string.
             * @param {boolean} [urlsafe] URL-and-filename-safe a la RFC4648 §5
             * @returns {string} Base64 string
             */
            var fromUint8Array = function (u8a, urlsafe) {
                if (urlsafe === void 0) { urlsafe = false; }
                return urlsafe ? _mkUriSafe(_fromUint8Array(u8a)) : _fromUint8Array(u8a);
            };
            // This trick is found broken https://github.com/dankogai/js-base64/issues/130
            // const utob = (src: string) => unescape(encodeURIComponent(src));
            // reverting good old fationed regexp
            var cb_utob = function (c) {
                if (c.length < 2) {
                    var cc = c.charCodeAt(0);
                    return cc < 0x80 ? c
                        : cc < 0x800 ? (_fromCC(0xc0 | (cc >>> 6))
                            + _fromCC(0x80 | (cc & 0x3f)))
                            : (_fromCC(0xe0 | ((cc >>> 12) & 0x0f))
                                + _fromCC(0x80 | ((cc >>> 6) & 0x3f))
                                + _fromCC(0x80 | (cc & 0x3f)));
                }
                else {
                    var cc = 0x10000
                        + (c.charCodeAt(0) - 0xD800) * 0x400
                        + (c.charCodeAt(1) - 0xDC00);
                    return (_fromCC(0xf0 | ((cc >>> 18) & 0x07))
                        + _fromCC(0x80 | ((cc >>> 12) & 0x3f))
                        + _fromCC(0x80 | ((cc >>> 6) & 0x3f))
                        + _fromCC(0x80 | (cc & 0x3f)));
                }
            };
            var re_utob = /[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g;
            /**
             * @deprecated should have been internal use only.
             * @param {string} src UTF-8 string
             * @returns {string} UTF-16 string
             */
            var utob = function (u) { return u.replace(re_utob, cb_utob); };
            //
            var _encode = _hasBuffer
                ? function (s) { return Buffer.from(s, 'utf8').toString('base64'); }
                : _TE
                    ? function (s) { return _fromUint8Array(_TE.encode(s)); }
                    : function (s) { return _btoa(utob(s)); };
            /**
             * converts a UTF-8-encoded string to a Base64 string.
             * @param {boolean} [urlsafe] if `true` make the result URL-safe
             * @returns {string} Base64 string
             */
            var encode = function (src, urlsafe) {
                if (urlsafe === void 0) { urlsafe = false; }
                return urlsafe
                    ? _mkUriSafe(_encode(src))
                    : _encode(src);
            };
            /**
             * converts a UTF-8-encoded string to URL-safe Base64 RFC4648 §5.
             * @returns {string} Base64 string
             */
            var encodeURI = function (src) { return encode(src, true); };
            // This trick is found broken https://github.com/dankogai/js-base64/issues/130
            // const btou = (src: string) => decodeURIComponent(escape(src));
            // reverting good old fationed regexp
            var re_btou = /[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g;
            var cb_btou = function (cccc) {
                switch (cccc.length) {
                    case 4:
                        var cp = ((0x07 & cccc.charCodeAt(0)) << 18)
                            | ((0x3f & cccc.charCodeAt(1)) << 12)
                            | ((0x3f & cccc.charCodeAt(2)) << 6)
                            | (0x3f & cccc.charCodeAt(3)), offset = cp - 0x10000;
                        return (_fromCC((offset >>> 10) + 0xD800)
                            + _fromCC((offset & 0x3FF) + 0xDC00));
                    case 3:
                        return _fromCC(((0x0f & cccc.charCodeAt(0)) << 12)
                            | ((0x3f & cccc.charCodeAt(1)) << 6)
                            | (0x3f & cccc.charCodeAt(2)));
                    default:
                        return _fromCC(((0x1f & cccc.charCodeAt(0)) << 6)
                            | (0x3f & cccc.charCodeAt(1)));
                }
            };
            /**
             * @deprecated should have been internal use only.
             * @param {string} src UTF-16 string
             * @returns {string} UTF-8 string
             */
            var btou = function (b) { return b.replace(re_btou, cb_btou); };
            /**
             * polyfill version of `atob`
             */
            var atobPolyfill = function (asc) {
                // console.log('polyfilled');
                asc = asc.replace(/\s+/g, '');
                if (!b64re.test(asc))
                    throw new TypeError('malformed base64.');
                asc += '=='.slice(2 - (asc.length & 3));
                var u24, bin = '', r1, r2;
                for (var i = 0; i < asc.length;) {
                    u24 = b64tab[asc.charAt(i++)] << 18
                        | b64tab[asc.charAt(i++)] << 12
                        | (r1 = b64tab[asc.charAt(i++)]) << 6
                        | (r2 = b64tab[asc.charAt(i++)]);
                    bin += r1 === 64 ? _fromCC(u24 >> 16 & 255)
                        : r2 === 64 ? _fromCC(u24 >> 16 & 255, u24 >> 8 & 255)
                            : _fromCC(u24 >> 16 & 255, u24 >> 8 & 255, u24 & 255);
                }
                return bin;
            };
            /**
             * does what `window.atob` of web browsers do.
             * @param {String} asc Base64-encoded string
             * @returns {string} binary string
             */
            var _atob = _hasatob ? function (asc) { return atob(_tidyB64(asc)); }
                : _hasBuffer ? function (asc) { return Buffer.from(asc, 'base64').toString('binary'); }
                    : atobPolyfill;
            //
            var _toUint8Array = _hasBuffer
                ? function (a) { return _U8Afrom(Buffer.from(a, 'base64')); }
                : function (a) { return _U8Afrom(_atob(a).split('').map(function (c) { return c.charCodeAt(0); })); };
            /**
             * converts a Base64 string to a Uint8Array.
             */
            var toUint8Array = function (a) { return _toUint8Array(_unURI(a)); };
            //
            var _decode = _hasBuffer
                ? function (a) { return Buffer.from(a, 'base64').toString('utf8'); }
                : _TD
                    ? function (a) { return _TD.decode(_toUint8Array(a)); }
                    : function (a) { return btou(_atob(a)); };
            var _unURI = function (a) { return _tidyB64(a.replace(/[-_]/g, function (m0) { return m0 == '-' ? '+' : '/'; })); };
            /**
             * converts a Base64 string to a UTF-8 string.
             * @param {String} src Base64 string.  Both normal and URL-safe are supported
             * @returns {string} UTF-8 string
             */
            var decode = function (src) { return _decode(_unURI(src)); };
            /**
             * check if a value is a valid Base64 string
             * @param {String} src a value to check
             */
            var isValid = function (src) {
                if (typeof src !== 'string')
                    return false;
                var s = src.replace(/\s+/g, '').replace(/={0,2}$/, '');
                return !/[^\s0-9a-zA-Z\+/]/.test(s) || !/[^\s0-9a-zA-Z\-_]/.test(s);
            };
            //
            var _noEnum = function (v) {
                return {
                    value: v, enumerable: false, writable: true, configurable: true
                };
            };
            /**
             * extend String.prototype with relevant methods
             */
            var extendString = function () {
                var _add = function (name, body) { return Object.defineProperty(String.prototype, name, _noEnum(body)); };
                _add('fromBase64', function () { return decode(this); });
                _add('toBase64', function (urlsafe) { return encode(this, urlsafe); });
                _add('toBase64URI', function () { return encode(this, true); });
                _add('toBase64URL', function () { return encode(this, true); });
                _add('toUint8Array', function () { return toUint8Array(this); });
            };
            /**
             * extend Uint8Array.prototype with relevant methods
             */
            var extendUint8Array = function () {
                var _add = function (name, body) { return Object.defineProperty(Uint8Array.prototype, name, _noEnum(body)); };
                _add('toBase64', function (urlsafe) { return fromUint8Array(this, urlsafe); });
                _add('toBase64URI', function () { return fromUint8Array(this, true); });
                _add('toBase64URL', function () { return fromUint8Array(this, true); });
            };
            /**
             * extend Builtin prototypes with relevant methods
             */
            var extendBuiltins = function () {
                extendString();
                extendUint8Array();
            };
            var gBase64 = {
                version: version,
                VERSION: VERSION,
                atob: _atob,
                atobPolyfill: atobPolyfill,
                btoa: _btoa,
                btoaPolyfill: btoaPolyfill,
                fromBase64: decode,
                toBase64: encode,
                encode: encode,
                encodeURI: encodeURI,
                encodeURL: encodeURI,
                utob: utob,
                btou: btou,
                decode: decode,
                isValid: isValid,
                fromUint8Array: fromUint8Array,
                toUint8Array: toUint8Array,
                extendString: extendString,
                extendUint8Array: extendUint8Array,
                extendBuiltins: extendBuiltins
            };
            //
            // export Base64 to the namespace
            //
            // ES5 is yet to have Object.assign() that may make transpilers unhappy.
            // gBase64.Base64 = Object.assign({}, gBase64);
            gBase64.Base64 = {};
            Object.keys(gBase64).forEach(function (k) { return gBase64.Base64[k] = gBase64[k]; });
            return gBase64;
        }));
        //==本JS是加载Lodop插件或Web打印服务CLodop/Lodop7的综合示例，可直接使用，建议理解后融入自己程序==
        var CreatedOKLodopObject, CLodopIsLocal, CLodopJsState;
        //==判断是否需要CLodop(那些不支持插件的浏览器):==
        function needCLodop() {
            try {
                var ua = navigator.userAgent;
                if (ua.match(/Windows\sPhone/i))   return true;
                if (ua.match(/iPhone|iPod|iPad/i)) return true;
                if (ua.match(/Android/i))          return true;
                if (ua.match(/Edge\D?\d+/i))       return true;

                var verTrident = ua.match(/Trident\D?\d+/i);
                var verIE = ua.match(/MSIE\D?\d+/i);
                var verOPR = ua.match(/OPR\D?\d+/i);
                var verFF = ua.match(/Firefox\D?\d+/i);
                var x64 = ua.match(/x64/i);
                if ((!verTrident) && (!verIE) && (x64)) return true;
                else if (verFF) {
                    verFF = verFF[0].match(/\d+/);
                    if ((verFF[0] >= 41) || (x64)) return true;
                } else if (verOPR) {
                    verOPR = verOPR[0].match(/\d+/);
                    if (verOPR[0] >= 32) return true;
                } else if ((!verTrident) && (!verIE)) {
                    var verChrome = ua.match(/Chrome\D?\d+/i);
                    if (verChrome) {
                        verChrome = verChrome[0].match(/\d+/);
                        if (verChrome[0] >= 41) return true;
                    }
                }
                return false;
            } catch (err) {
                return true;
            }
        }

        //加载CLodop时用双端口(http是8000/18000,而https是8443/8444)以防其中某端口被占,
        //主JS文件名“CLodopfuncs.js”是固定名称，其内容是动态的，与其链接的打印环境有关:
        function loadCLodop() {
            if (CLodopJsState == "loading" || CLodopJsState == "complete") return;
            CLodopJsState = "loading";
            var head = document.head || document.getElementsByTagName("head")[0] || document.documentElement;
            var JS1 = document.createElement("script");
            var JS2 = document.createElement("script");

            if (window.location.protocol=='https:') {
                JS1.src = "https://localhost.lodop.net:8443/CLodopfuncs.js";
                JS2.src = "https://localhost.lodop.net:8444/CLodopfuncs.js";
            } else {
                JS1.src = "http://localhost:8000/CLodopfuncs.js";
                JS2.src = "http://localhost:18000/CLodopfuncs.js";
            }
            JS1.onload  = JS2.onload  = function()    {CLodopJsState = "complete";}
            JS1.onerror = JS2.onerror = function(evt) {CLodopJsState = "complete";}
            head.insertBefore(JS1, head.firstChild);
            head.insertBefore(JS2, head.firstChild);
            CLodopIsLocal = !!((JS1.src + JS2.src).match(/\/\/localho|\/\/127.0.0./i));
        }

        if (needCLodop()){loadCLodop();}//开始加载

        //==获取LODOP对象主过程,判断是否安装、需否升级:==
        function getLodop(oOBJECT, oEMBED) {
            var strFontTag= "<br><font color='#FF00FF'>打印控件";
            var strLodopInstall   = strFontTag+"未安装!点击这里<a href='install_lodop32.exe' target='_self'>执行安装</a>";
            var strLodopUpdate    = strFontTag+"需要升级!点击这里<a href='install_lodop32.exe' target='_self'>执行升级</a>";
            var strLodop64Install = strFontTag+"未安装!点击这里<a href='install_lodop64.exe' target='_self'>执行安装</a>";
            var strLodop64Update  = strFontTag+"需要升级!点击这里<a href='install_lodop64.exe' target='_self'>执行升级</a>";
            var strCLodopInstallA = "<br><font color='#FF00FF'>Web打印服务CLodop未安装启动，点击这里<a href='CLodop_Setup_for_Win32NT.exe' target='_self'>下载执行安装</a>";
            var strCLodopInstallB = "<br>（若此前已安装过，可<a href='CLodop.protocol:setup' target='_self'>点这里直接再次启动</a>）";
            var strCLodopUpdate   = "<br><font color='#FF00FF'>Web打印服务CLodop需升级!点击这里<a href='CLodop_Setup_for_Win32NT.exe' target='_self'>执行升级</a>";
            var strLodop7FontTag    = "<br><font color='#FF00FF'>Web打印服务Lodop7";
            var strLodop7HrefX86    = "点击这里<a href='Lodop7_Linux_X86_64.tar.gz' target='_self'>下载安装</a>(下载后解压，点击lodop文件开始执行)";
            var strLodop7HrefARM    = "点击这里<a href='Lodop7_Linux_ARM64.tar.gz'  target='_self'>下载安装</a>(下载后解压，点击lodop文件开始执行)";
            var strLodop7Install_X86 = strLodop7FontTag+"未安装启动，"+strLodop7HrefX86;
            var strLodop7Install_ARM = strLodop7FontTag+"未安装启动，"+strLodop7HrefARM;
            var strLodop7Update_X86  = strLodop7FontTag+"需升级，"+strLodop7HrefX86;
            var strLodop7Update_ARM  = strLodop7FontTag+"需升级，"+strLodop7HrefARM;
            var strInstallOK = "，成功后请刷新本页面或重启浏览器。</font>";
            var LODOP;
            try {
                var isWinIE    = (/MSIE/i.test(navigator.userAgent)) || (/Trident/i.test(navigator.userAgent));
                var isWinIE64  = isWinIE && (/x64/i.test(navigator.userAgent));
                var isLinuxX86 = (/Linux/i.test(navigator.platform)) && (/x86/i.test(navigator.platform));
                var isLinuxARM = (/Linux/i.test(navigator.platform)) && (/aarch/i.test(navigator.platform));

                if (needCLodop() || isLinuxX86 || isLinuxARM) {
                    try {
                        LODOP = getCLodop();
                    } catch (err) {}
                    if (!LODOP && CLodopJsState !== "complete") {
                        if (CLodopJsState == "loading") alert("网页还没下载完毕，请稍等一下再操作."); else alert("未曾加载Lodop主JS文件，请先调用loadCLodop过程.");
                        return;
                    }
                    var strAlertMessage;
                    if (!LODOP) {
                        if (isLinuxX86) strAlertMessage = strLodop7Install_X86; else
                        if (isLinuxARM) strAlertMessage = strLodop7Install_ARM; else
                            strAlertMessage = strCLodopInstallA + (CLodopIsLocal ? strCLodopInstallB : "") ;
                        document.body.innerHTML = strAlertMessage + strInstallOK + document.body.innerHTML;
                        return;
                    } else {
                        if (isLinuxX86 && LODOP.CVERSION < "7.0.4.3") strAlertMessage = strLodop7Update_X86; else
                        if (isLinuxARM && LODOP.CVERSION < "7.0.4.3") strAlertMessage = strLodop7Update_ARM; else
                        if (CLODOP.CVERSION < "4.1.6.1")              strAlertMessage = strCLodopUpdate;

                        if (strAlertMessage) document.body.innerHTML = strAlertMessage+ strInstallOK + document.body.innerHTML;
                    }
                } else { //==如果页面有Lodop插件就直接使用,否则新建:==
                    if (oOBJECT || oEMBED) {
                        if (isWinIE)
                            LODOP = oOBJECT;
                        else
                            LODOP = oEMBED;
                    } else if (!CreatedOKLodopObject) {
                        LODOP = document.createElement("object");
                        LODOP.setAttribute("width", 0);
                        LODOP.setAttribute("height", 0);
                        LODOP.setAttribute("style", "position:absolute;left:0px;top:-100px;width:0px;height:0px;");
                        if (isWinIE)
                            LODOP.setAttribute("classid", "clsid:2105C259-1E0C-4534-8141-A753534CB4CA");
                        else
                            LODOP.setAttribute("type", "application/x-print-lodop");
                        document.documentElement.appendChild(LODOP);
                        CreatedOKLodopObject = LODOP;
                    } else
                        LODOP = CreatedOKLodopObject;
                    //==Lodop插件未安装时提示下载地址:==
                    if ((!LODOP) || (!LODOP.VERSION)) {
                        document.body.innerHTML = (isWinIE64 ? strLodop64Install : strLodopInstall) + strInstallOK + document.body.innerHTML;
                        return LODOP;
                    }
                    if (LODOP.VERSION < "6.2.2.6") {
                        document.body.innerHTML = (isWinIE64 ? strLodop64Update : strLodopUpdate) + strInstallOK + document.body.innerHTML;
                    }
                }
                //===如下空白位置适合调用统一功能(如注册语句、语言选择等):=======================


                //===============================================================================
                return LODOP;
            } catch (err) {
                alert("getLodop出错:" + err);
            }
        }
    </script>
    <object  id="LODOP_OB" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0>
        <embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0></embed>
    </object>
    <script type="text/javascript">
        !function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).dragula=e()}(function(){return function o(r,i,u){function c(t,e){if(!i[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(a)return a(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}},r[t][0].call(n.exports,function(e){return c(r[t][1][e]||e)},n,n.exports,o,r,i,u)}return i[t].exports}for(var a="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,n){"use strict";var o={},r="(?:^|\\s)",i="(?:\\s|$)";function u(e){var t=o[e];return t?t.lastIndex=0:o[e]=t=new RegExp(r+e+i,"g"),t}t.exports={add:function(e,t){var n=e.className;n.length?u(t).test(n)||(e.className+=" "+t):e.className=t},rm:function(e,t){e.className=e.className.replace(u(t)," ").trim()}}},{}],2:[function(e,t,n){(function(r){"use strict";var M=e("contra/emitter"),k=e("crossvent"),j=e("./classes"),R=document,q=R.documentElement;function U(e,t,n,o){r.navigator.pointerEnabled?k[t](e,{mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"}[n],o):r.navigator.msPointerEnabled?k[t](e,{mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"}[n],o):(k[t](e,{mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"}[n],o),k[t](e,n,o))}function K(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;e=e.button;return void 0!==e?1&e?1:2&e?3:4&e?2:0:void 0}function z(e,t){return void 0!==r[t]?r[t]:(q.clientHeight?q:R.body)[e]}function H(e,t,n){var o=(e=e||{}).className||"";return e.className+=" gu-hide",n=R.elementFromPoint(t,n),e.className=o,n}function V(){return!1}function $(){return!0}function G(e){return e.width||e.right-e.left}function J(e){return e.height||e.bottom-e.top}function Q(e){return e.parentNode===R?null:e.parentNode}function W(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||function e(t){if(!t)return!1;if("false"===t.contentEditable)return!1;if("true"===t.contentEditable)return!0;return e(Q(t))}(e)}function Z(t){return t.nextElementSibling||function(){var e=t;for(;e=e.nextSibling,e&&1!==e.nodeType;);return e}()}function ee(e,t){var t=(n=t).targetTouches&&n.targetTouches.length?n.targetTouches[0]:n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,n={pageX:"clientX",pageY:"clientY"};return e in n&&!(e in t)&&n[e]in t&&(e=n[e]),t[e]}t.exports=function(e,t){var l,f,s,d,m,o,r,v,p,h,n;1===arguments.length&&!1===Array.isArray(e)&&(t=e,e=[]);var i,g=null,y=t||{};void 0===y.moves&&(y.moves=$),void 0===y.accepts&&(y.accepts=$),void 0===y.invalid&&(y.invalid=function(){return!1}),void 0===y.containers&&(y.containers=e||[]),void 0===y.isContainer&&(y.isContainer=V),void 0===y.copy&&(y.copy=!1),void 0===y.copySortSource&&(y.copySortSource=!1),void 0===y.revertOnSpill&&(y.revertOnSpill=!1),void 0===y.removeOnSpill&&(y.removeOnSpill=!1),void 0===y.direction&&(y.direction="vertical"),void 0===y.ignoreInputTextSelection&&(y.ignoreInputTextSelection=!0),void 0===y.mirrorContainer&&(y.mirrorContainer=R.body);var w=M({containers:y.containers,start:function(e){e=S(e);e&&C(e)},end:O,cancel:L,remove:X,destroy:function(){c(!0),N({})},canMove:function(e){return!!S(e)},dragging:!1});return!0===y.removeOnSpill&&w.on("over",function(e){j.rm(e,"gu-hide")}).on("out",function(e){w.dragging&&j.add(e,"gu-hide")}),c(),w;function u(e){return-1!==w.containers.indexOf(e)||y.isContainer(e)}function c(e){e=e?"remove":"add";U(q,e,"mousedown",E),U(q,e,"mouseup",N)}function a(e){U(q,e?"remove":"add","mousemove",x)}function b(e){e=e?"remove":"add";k[e](q,"selectstart",T),k[e](q,"click",T)}function T(e){i&&e.preventDefault()}function E(e){var t,n;o=e.clientX,r=e.clientY,1!==K(e)||e.metaKey||e.ctrlKey||(n=S(t=e.target))&&(i=n,a(),"mousedown"===e.type&&(W(t)?t.focus():e.preventDefault()))}function x(e){if(i)if(0!==K(e)){if(!(void 0!==e.clientX&&Math.abs(e.clientX-o)<=(y.slideFactorX||0)&&void 0!==e.clientY&&Math.abs(e.clientY-r)<=(y.slideFactorY||0))){if(y.ignoreInputTextSelection){var t=ee("clientX",e)||0,n=ee("clientY",e)||0;if(W(R.elementFromPoint(t,n)))return}n=i;a(!0),b(),O(),C(n);n=function(e){e=e.getBoundingClientRect();return{left:e.left+z("scrollLeft","pageXOffset"),top:e.top+z("scrollTop","pageYOffset")}}(s);d=ee("pageX",e)-n.left,m=ee("pageY",e)-n.top,j.add(h||s,"gu-transit"),function(){if(l)return;var e=s.getBoundingClientRect();(l=s.cloneNode(!0)).style.width=G(e)+"px",l.style.height=J(e)+"px",j.rm(l,"gu-transit"),j.add(l,"gu-mirror"),y.mirrorContainer.appendChild(l),U(q,"add","mousemove",P),j.add(y.mirrorContainer,"gu-unselectable"),w.emit("cloned",l,s,"mirror")}(),P(e)}}else N({})}function S(e){if(!(w.dragging&&l||u(e))){for(var t=e;Q(e)&&!1===u(Q(e));){if(y.invalid(e,t))return;if(!(e=Q(e)))return}var n=Q(e);if(n)if(!y.invalid(e,t))if(y.moves(e,n,t,Z(e)))return{item:e,source:n}}}function C(e){var t,n;t=e.item,n=e.source,("boolean"==typeof y.copy?y.copy:y.copy(t,n))&&(h=e.item.cloneNode(!0),w.emit("cloned",h,e.item,"copy")),f=e.source,s=e.item,v=p=Z(e.item),w.dragging=!0,w.emit("drag",s,f)}function O(){var e;w.dragging&&_(e=h||s,Q(e))}function I(){a(!(i=!1)),b(!0)}function N(e){var t,n;I(),w.dragging&&(t=h||s,n=ee("clientX",e)||0,e=ee("clientY",e)||0,(e=B(H(l,n,e),n,e))&&(h&&y.copySortSource||!h||e!==f)?_(t,e):(y.removeOnSpill?X:L)())}function _(e,t){var n=Q(e);h&&y.copySortSource&&t===f&&n.removeChild(s),A(t)?w.emit("cancel",e,f,f):w.emit("drop",e,t,f,p),Y()}function X(){var e,t;w.dragging&&((t=Q(e=h||s))&&t.removeChild(e),w.emit(h?"cancel":"remove",e,t,f),Y())}function L(e){var t,n,o;w.dragging&&(t=0<arguments.length?e:y.revertOnSpill,!1===(e=A(o=Q(n=h||s)))&&t&&(h?o&&o.removeChild(h):f.insertBefore(n,v)),e||t?w.emit("cancel",n,f,f):w.emit("drop",n,o,f,p),Y())}function Y(){var e=h||s;I(),l&&(j.rm(y.mirrorContainer,"gu-unselectable"),U(q,"remove","mousemove",P),Q(l).removeChild(l),l=null),e&&j.rm(e,"gu-transit"),n&&clearTimeout(n),w.dragging=!1,g&&w.emit("out",e,g,f),w.emit("dragend",e),f=s=h=v=p=n=g=null}function A(e,t){t=void 0!==t?t:l?p:Z(h||s);return e===f&&t===v}function B(t,n,o){for(var r=t;r&&!function(){if(!1===u(r))return!1;var e=D(r,t),e=F(r,e,n,o);if(A(r,e))return!0;return y.accepts(s,r,f,e)}();)r=Q(r);return r}function P(e){if(l){e.preventDefault();var t=ee("clientX",e)||0,n=ee("clientY",e)||0,o=t-d,r=n-m;l.style.left=o+"px",l.style.top=r+"px";var i=h||s,e=H(l,t,n),o=B(e,t,n),u=null!==o&&o!==g;!u&&null!==o||(g&&a("out"),g=o,u&&a("over"));r=Q(i);if(o!==f||!h||y.copySortSource){var c,e=D(o,e);if(null!==e)c=F(o,e,t,n);else{if(!0!==y.revertOnSpill||h)return void(h&&r&&r.removeChild(i));c=v,o=f}(null===c&&u||c!==i&&c!==Z(i))&&(p=c,o.insertBefore(i,c),w.emit("shadow",i,o,f))}else r&&r.removeChild(i)}function a(e){w.emit(e,i,g,f)}}function D(e,t){for(var n=t;n!==e&&Q(n)!==e;)n=Q(n);return n===q?null:n}function F(r,t,i,u){var c="horizontal"===y.direction;return(t!==r?function(){var e=t.getBoundingClientRect();if(c)return n(i>e.left+G(e)/2);return n(u>e.top+J(e)/2)}:function(){var e,t,n,o=r.children.length;for(e=0;e<o;e++){if(t=r.children[e],n=t.getBoundingClientRect(),c&&n.left+n.width/2>i)return t;if(!c&&n.top+n.height/2>u)return t}return null})();function n(e){return e?Z(t):t}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./classes":1,"contra/emitter":5,crossvent:6}],3:[function(e,t,n){t.exports=function(e,t){return Array.prototype.slice.call(e,t)}},{}],4:[function(e,t,n){"use strict";var o=e("ticky");t.exports=function(e,t,n){e&&o(function(){e.apply(n||null,t||[])})}},{ticky:10}],5:[function(e,t,n){"use strict";var c=e("atoa"),a=e("./debounce");t.exports=function(r,e){var i=e||{},u={};return void 0===r&&(r={}),r.on=function(e,t){return u[e]?u[e].push(t):u[e]=[t],r},r.once=function(e,t){return t._once=!0,r.on(e,t),r},r.off=function(e,t){var n=arguments.length;if(1===n)delete u[e];else if(0===n)u={};else{e=u[e];if(!e)return r;e.splice(e.indexOf(t),1)}return r},r.emit=function(){var e=c(arguments);return r.emitterSnapshot(e.shift()).apply(this,e)},r.emitterSnapshot=function(o){var e=(u[o]||[]).slice(0);return function(){var t=c(arguments),n=this||r;if("error"===o&&!1!==i.throws&&!e.length)throw 1===t.length?t[0]:t;return e.forEach(function(e){i.async?a(e,t,n):e.apply(n,t),e._once&&r.off(o,e)}),r}},r}},{"./debounce":4,atoa:3}],6:[function(n,o,e){(function(r){"use strict";var i=n("custom-event"),u=n("./eventmap"),c=r.document,e=function(e,t,n,o){return e.addEventListener(t,n,o)},t=function(e,t,n,o){return e.removeEventListener(t,n,o)},a=[];function l(e,t,n){t=function(e,t,n){var o,r;for(o=0;o<a.length;o++)if((r=a[o]).element===e&&r.type===t&&r.fn===n)return o}(e,t,n);if(t){n=a[t].wrapper;return a.splice(t,1),n}}r.addEventListener||(e=function(e,t,n){return e.attachEvent("on"+t,function(e,t,n){var o=l(e,t,n)||function(n,o){return function(e){var t=e||r.event;t.target=t.target||t.srcElement,t.preventDefault=t.preventDefault||function(){t.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){t.cancelBubble=!0},t.which=t.which||t.keyCode,o.call(n,t)}}(e,n);return a.push({wrapper:o,element:e,type:t,fn:n}),o}(e,t,n))},t=function(e,t,n){n=l(e,t,n);if(n)return e.detachEvent("on"+t,n)}),o.exports={add:e,remove:t,fabricate:function(e,t,n){var o=-1===u.indexOf(t)?new i(t,{detail:n}):function(){var e;c.createEvent?(e=c.createEvent("Event")).initEvent(t,!0,!0):c.createEventObject&&(e=c.createEventObject());return e}();e.dispatchEvent?e.dispatchEvent(o):e.fireEvent("on"+t,o)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./eventmap":7,"custom-event":8}],7:[function(e,r,t){(function(e){"use strict";var t=[],n="",o=/^on/;for(n in e)o.test(n)&&t.push(n.slice(2));r.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,n,t){(function(e){var t=e.CustomEvent;n.exports=function(){try{var e=new t("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(e){}}()?t:"undefined"!=typeof document&&"function"==typeof document.createEvent?function(e,t){var n=document.createEvent("CustomEvent");return t?n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail):n.initCustomEvent(e,!1,!1,void 0),n}:function(e,t){var n=document.createEventObject();return n.type=e,t?(n.bubbles=Boolean(t.bubbles),n.cancelable=Boolean(t.cancelable),n.detail=t.detail):(n.bubbles=!1,n.cancelable=!1,n.detail=void 0),n}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,t,n){var o,r,t=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(t){if(o===setTimeout)return setTimeout(t,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(e){try{return o.call(null,t,0)}catch(e){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(e){o=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}}();var a,l=[],f=!1,s=-1;function d(){f&&a&&(f=!1,a.length?l=a.concat(l):s=-1,l.length&&m())}function m(){if(!f){var e=c(d);f=!0;for(var t=l.length;t;){for(a=l,l=[];++s<t;)a&&a[s].run();s=-1,t=l.length}a=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function p(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new v(e,t)),1!==l.length||f||c(m)},v.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=p,t.addListener=p,t.once=p,t.off=p,t.removeListener=p,t.removeAllListeners=p,t.emit=p,t.prependListener=p,t.prependOnceListener=p,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],10:[function(e,n,t){(function(t){var e="function"==typeof t?function(e){t(e)}:function(e){setTimeout(e,0)};n.exports=e}).call(this,e("timers").setImmediate)},{timers:11}],11:[function(a,e,l){(function(e,t){var o=a("process/browser.js").nextTick,n=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function c(e,t){this._id=e,this._clearFn=t}l.setTimeout=function(){return new c(n.call(setTimeout,window,arguments),clearTimeout)},l.setInterval=function(){return new c(n.call(setInterval,window,arguments),clearInterval)},l.clearTimeout=l.clearInterval=function(e){e.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},l.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},l.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},l._unrefActive=l.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},l.setImmediate="function"==typeof e?e:function(e){var t=u++,n=!(arguments.length<2)&&r.call(arguments,1);return i[t]=!0,o(function(){i[t]&&(n?e.apply(null,n):e.call(null),l.clearImmediate(t))}),t},l.clearImmediate="function"==typeof t?t:function(e){delete i[e]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":9,timers:11}]},{},[2])(2)});
        !function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ClipboardJS=e():t.ClipboardJS=e()}(this,function(){return n={686:function(t,e,n){"use strict";n.d(e,{default:function(){return b}});var e=n(279),i=n.n(e),e=n(370),u=n.n(e),e=n(817),r=n.n(e);function c(t){try{return document.execCommand(t)}catch(t){return}}var a=function(t){t=r()(t);return c("cut"),t};function o(t,e){var n,o,t=(n=t,o="rtl"===document.documentElement.getAttribute("dir"),(t=document.createElement("textarea")).style.fontSize="12pt",t.style.border="0",t.style.padding="0",t.style.margin="0",t.style.position="absolute",t.style[o?"right":"left"]="-9999px",o=window.pageYOffset||document.documentElement.scrollTop,t.style.top="".concat(o,"px"),t.setAttribute("readonly",""),t.value=n,t);return e.container.appendChild(t),e=r()(t),c("copy"),t.remove(),e}var f=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{container:document.body},n="";return"string"==typeof t?n=o(t,e):t instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(null==t?void 0:t.type)?n=o(t.value,e):(n=r()(t),c("copy")),n};function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var s=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.action,n=void 0===e?"copy":e,o=t.container,e=t.target,t=t.text;if("copy"!==n&&"cut"!==n)throw new Error('Invalid "action" value, use either "copy" or "cut"');if(void 0!==e){if(!e||"object"!==l(e)||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===n&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===n&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}return t?f(t,{container:o}):e?"cut"===n?a(e):f(e,{container:o}):void 0};function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=v(n);return t=o?(t=v(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,!(t=t)||"object"!==p(t)&&"function"!=typeof t?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){t="data-clipboard-".concat(t);if(e.hasAttribute(t))return e.getAttribute(t)}var b=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(r,i());var t,e,n,o=h(r);function r(t,e){var n;return function(t){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this),(n=o.call(this)).resolveOptions(e),n.listenClick(t),n}return t=r,n=[{key:"copy",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{container:document.body};return f(t,e)}},{key:"cut",value:function(t){return a(t)}},{key:"isSupported",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof t?[t]:t,e=!!document.queryCommandSupported;return t.forEach(function(t){e=e&&!!document.queryCommandSupported(t)}),e}}],(e=[{key:"resolveOptions",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===p(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=u()(t,"click",function(t){return e.onClick(t)})}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget,n=this.action(e)||"copy",t=s({action:n,container:this.container,target:this.target(e),text:this.text(e)});this.emit(t?"success":"error",{action:n,text:t,trigger:e,clearSelection:function(){e&&e.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(t){return m("action",t)}},{key:"defaultTarget",value:function(t){t=m("target",t);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(t){return m("text",t)}},{key:"destroy",value:function(){this.listener.destroy()}}])&&d(t.prototype,e),n&&d(t,n),r}()},828:function(t){var e;"undefined"==typeof Element||Element.prototype.matches||((e=Element.prototype).matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector),t.exports=function(t,e){for(;t&&9!==t.nodeType;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}},438:function(t,e,n){var u=n(828);function i(t,e,n,o,r){var i=function(e,n,t,o){return function(t){t.delegateTarget=u(t.target,n),t.delegateTarget&&o.call(e,t)}}.apply(this,arguments);return t.addEventListener(n,i,r),{destroy:function(){t.removeEventListener(n,i,r)}}}t.exports=function(t,e,n,o,r){return"function"==typeof t.addEventListener?i.apply(null,arguments):"function"==typeof n?i.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,function(t){return i(t,e,n,o,r)}))}},879:function(t,n){n.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},n.nodeList=function(t){var e=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in t&&(0===t.length||n.node(t[0]))},n.string=function(t){return"string"==typeof t||t instanceof String},n.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},370:function(t,e,n){var f=n(879),l=n(438);t.exports=function(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!f.string(e))throw new TypeError("Second argument must be a String");if(!f.fn(n))throw new TypeError("Third argument must be a Function");if(f.node(t))return c=e,a=n,(u=t).addEventListener(c,a),{destroy:function(){u.removeEventListener(c,a)}};if(f.nodeList(t))return o=t,r=e,i=n,Array.prototype.forEach.call(o,function(t){t.addEventListener(r,i)}),{destroy:function(){Array.prototype.forEach.call(o,function(t){t.removeEventListener(r,i)})}};if(f.string(t))return t=t,e=e,n=n,l(document.body,t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList");var o,r,i,u,c,a}},817:function(t){t.exports=function(t){var e,n="SELECT"===t.nodeName?(t.focus(),t.value):"INPUT"===t.nodeName||"TEXTAREA"===t.nodeName?((e=t.hasAttribute("readonly"))||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),e||t.removeAttribute("readonly"),t.value):(t.hasAttribute("contenteditable")&&t.focus(),n=window.getSelection(),(e=document.createRange()).selectNodeContents(t),n.removeAllRanges(),n.addRange(e),n.toString());return n}},279:function(t){function e(){}e.prototype={on:function(t,e,n){var o=this.e||(this.e={});return(o[t]||(o[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var o=this;function r(){o.off(t,r),e.apply(n,arguments)}return r._=e,this.on(t,r,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),o=0,r=n.length;o<r;o++)n[o].fn.apply(n[o].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),o=n[t],r=[];if(o&&e)for(var i=0,u=o.length;i<u;i++)o[i].fn!==e&&o[i].fn._!==e&&r.push(o[i]);return r.length?n[t]=r:delete n[t],this}},t.exports=e,t.exports.TinyEmitter=e}},r={},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,{a:e}),e},o.d=function(t,e){for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o(686).default;function o(t){if(r[t])return r[t].exports;var e=r[t]={exports:{}};return n[t](e,e.exports,o),e.exports}var n,r});
    </script>
    <style type="text/css">
        .gu-mirror{position:fixed!important;margin:0!important;z-index:9999!important;opacity:.8}.gu-hide{display:none!important}.gu-unselectable{-webkit-user-select:none!important;-moz-user-select:none!important;-ms-user-select:none!important;user-select:none!important}.gu-transit{opacity:.2}
        #content {
            border: 1px dotted #ccc;
        }
        #tool {
            position: absolute;
            right: 10px;
            top: 10px;
            border: 1px solid #000;
            padding: 5px;
        }
        #width, #height {
            width: 50px;
        }
        #style {
            height: 150px;
        }
        #xy {
            position: absolute;
            top: 3px;
            left: 3px;
        }
        #reset {
            position: absolute;
            top: 3px;
            right: 3px;
        }
    </style>
    <script type="text/javascript">
        function $(v) {
            return document.getElementById(v);
        }
        function render() {
            clearInterval(window.i);
            window.i = setInterval(function () {
                let els = document.getElementsByClassName('gu-mirror');
                if (els.length > 0) {
                    window.cssTop = els[0].style.top;
                    window.cssLeft = els[0].style.left;
                }
                if (window.cssTop) {
                    $('xy').innerHTML = 'X：' + window.cssLeft + '，Y：' + window.cssTop;
                }
                if (window.lastEl && !window.elFlag) {
                    $('el').value = window.lastEl.innerHTML;
                    $('style').value = window.lastEl.getAttribute('style');
                    $('left').value = window.lastEl.style.left;
                    $('top').value = window.lastEl.style.top;
                }
                if ($('content').outerHTML.length > 50) {
                    window.localStorage.setItem('content_html', $('content').outerHTML);
                }
            }, 10);
            dragula([$('content')]).on('drag', function (el) {
                window.elFlag = false;
            });
            dragula([$('content')]).on('dragend', function (el) {
                el.style.position = 'absolute';
                el.style.top = window.cssTop;
                el.style.left = window.cssLeft;
                window.lastEl = el;
            });
            $('content').childNodes.forEach(function (node, index) {
                node.removeEventListener('click', function () {
                });
                node.addEventListener('click', function () {
                    window.elFlag = false;
                    node.focus();
                    window.lastEl = node;
                });
            });
        }
        function reset_image() {
            document.getElementsByName('image')[0].value = 'print_' + (new Date().getTime()).toString() + '.jpg';
            window.localStorage.setItem('image', document.getElementsByName('image')[0].value);
        }
        function reset_excel() {
            document.getElementsByName('excel')[0].value = 'print_' + (new Date().getTime()).toString() + '.jpg';
            window.localStorage.setItem('excel', document.getElementsByName('excel')[0].value);
        }
        function set_wh() {
            $('content').style.width = $('width').value + 'px';
            $('content').style.height = $('height').value + 'px';
            render();
        }
        function add_var() {
            let div = document.createElement('div');
            div.innerHTML = '{' + $('name').value + '}';
            $('content').appendChild(div);
            $('name').value = '';
        }
        function add_text() {
            let div = document.createElement('div');
            div.innerHTML = $('text').value;
            $('content').appendChild(div);
            $('text').value = '';
        }
        function add_barcode() {
            let div = document.createElement('div');
            div.innerHTML = '<img src="http://www.apiorder.com/base/image/barcode?no=' + $('barcode').value + '" />';
            $('content').appendChild(div);
            $('barcode').value = '';
        }
        function set_el(b) {
            window.elFlag = b;
            if (window.lastEl) {
                window.lastEl.innerHTML = $('el').value;
            }
        }
        function set_el_x(b) {
            window.elFlag = b;
            if (window.lastEl) {
                window.lastEl.style.left = $('left').value;
            }
        }
        function set_el_y(b) {
            window.elFlag = b;
            if (window.lastEl) {
                window.lastEl.style.top = $('top').value;
            }
        }
        function set_style() {
            window.elFlag = false;
            if (window.lastEl) {
                window.lastEl.setAttribute('style', $('style').value);
            }
        }
        function remove_el() {
            if (window.lastEl) {
                window.lastEl.parentNode.removeChild(window.lastEl);
            }
        }
        function reset() {
            $('content').outerHTML = window.localStorage.getItem('content_html');
            render();
        }
        function use_html() {
            if ($('code').value.indexOf('id="content"') == -1) {
                $('code').value = Base64.decode($('code').value);
            }
           $('content').outerHTML = $('code').value;
           render();
        }
        function make_html() {
            $('code').value = $('content').outerHTML;
        }
        function make_encode() {
            $('code').value = Base64.encode($('content').outerHTML);
        }
        function upload_image_callback(el)
        {
            let image = window.localStorage.getItem('image');
            if (image && image.length > 0) {
                let xhr = new XMLHttpRequest();
                xhr.open('get', 'http://www.apiorder.com/tool/image/uploadTempJson/id/' + image.split('.')[0]);
                xhr.send();
                xhr.onload = function(){
                    let data = eval('(' + xhr.responseText + ')');
                    if (data.n) {
                        let div = document.createElement('div');
                        div.innerHTML = '<img src="http://www.apiorder.com/public/static/asset/file/temp/' + data.n + '" />';
                        $('content').prepend(div);
                        window.localStorage.setItem('image', '');
                        render();
                    }
                };
            }
        }
        function upload_excel_callback(el)
        {
            let excel = window.localStorage.getItem('excel');
            if (excel && excel.length > 0) {
                let xhr = new XMLHttpRequest();
                xhr.open('get', 'http://www.apiorder.com/tool/excel/uploadTempJson/id/' + excel.split('.')[0]);
                xhr.send();
                xhr.onload = function(){
                    let data = eval('(' + xhr.responseText + ')');
                    window.listData = data;
                    let optHtml = '';
                    for (let key in data) {
                        for (let k in data[key]) {
                            optHtml += '<option value="' + key + '" title=\'' + JSON.stringify(data[key]) + '\'>' + data[key][k] + '</option>';
                            break;
                        }
                    }
                    $('list').innerHTML = optHtml;
                    window.localStorage.setItem('excel', '');
                    render();
                };
            }
        }
        window.onload = function () {
            let html = window.localStorage.getItem('content_html');
            if (html.length > 0) {
                let div = document.createElement('div');
                div.setAttribute('id', 'reset');
                div.innerHTML = '<button onclick="reset()">恢复上一次</button>';
                $('tool').appendChild(div);
            }
            new ClipboardJS('.copy');
        };
        function do_print() {
            let oldHtml = $('content').outerHTML;
            let list = $('list').selectedOptions;
            if (list.length > 0) {
                for (let i = 0; i < list.length; i++) {
                    let data = window.listData[i];
                    let first = '';
                    for (let key in data) {
                        if (first.length == 0) {
                            first = key + '_' + data[key];
                        }
                        oldHtml = oldHtml.replace('{' + key + '}', data[key]);
                    }
                    print_html(oldHtml, first);
                }
            } else {
                alert('请至少在上方选择一项！');
            }
        }
        function print_html(html, name) {
            try {
                if (LODOP) {
                    LODOP.SET_SHOW_MODE("LANGUAGE", 0);
                    LODOP.SET_LICENSES("", "13F237F88D266504E91925FBD0D23831505", "", "");
                    LODOP.PRINT_INIT("打印工具 " + name);
                    LODOP.ADD_PRINT_HTM(0, 0, $('content').style.width.replace('px', ''), $('content').style.height.replace('px', ''), html);
                    LODOP.PRINT();
                } else {
                    alert('没有安装打印机！');
                }
            } catch (e) {
                alert('加载打印机组件失败！');
            }
        }
        function do_all() {
            let len = $('list').options.length;
            for (let i = 0; i < len; i++) {
                $('list').options[i].setAttribute('selected', 'selected');
            }
        }
    </script>
</head>
<body>
    <div id="content">
    </div>
    <div id="tool">
        <div id="xy"></div>
        <dl>
            <dt>面单大小</dt>
            <dd>宽：<input type="text" id="width" /> 高：<input type="text" id="height" /></dd>
            <dd style="text-align: right"><button onclick="set_wh()">确定</button></dd>
            <dd><br /></dd>
            <dt>插入图片</dt>
            <dd>
                <form action="http://www.apiorder.com/tool/image/uploadTemp" method="post" enctype="multipart/form-data" target="_image">
                    <input type="hidden" name="image" />
                    <input type="file" name="file" onchange="reset_image();this.parentNode.submit()" />
                </form>
            </dd>
            <dd><br /></dd>
            <dt>变量(例如：姓名)</dt>
            <dd><input type="text" id="name" autocomplete="off" /><button style="float: right" onclick="add_var()">添加</button></dd>
            <dt>文本(例如：备注)</dt>
            <dd><input type="text" id="text" autocomplete="off" /><button style="float: right" onclick="add_text()">添加</button></dd>
            <dt>条形码</dt>
            <dd><input type="text" id="barcode" autocomplete="off" /><button style="float: right" onclick="add_barcode()">添加</button></dd>
            <dd><br /></dd>
            <dd style="text-align: right"><button style="float: left" onclick="use_html()">应用代码</button><button style="float: left" onclick="make_encode()">生成密文</button><button onclick="make_html()">生成代码</button></dd>
            <dd><textarea id="code" placeholder="点击上方按钮生成代码"></textarea></dd>
            <dd style="text-align: right"><button style="float: left" onclick="print_html($('content').outerHTML)">直接打印</button><button class="copy" data-clipboard-target="#code">复制</button></dd>
        </dl>
        <hr />
        <dl>
            <dt>当前元素</dt>
            <dd><input type="text" id="el" onfocus="window.elFlag = true" onblur="set_el(false);" onkeydown="event.keyCode == 13 ? set_el(true) : false" autocomplete="off" /></dd>
            <dt>属性</dt>
            <dd><textarea id="style" style="height: 100px" onfocus="window.elFlag = true" onchange="set_style();" autocomplete="off"></textarea></dd>
            <dd>X<input type="text" id="left" onfocus="window.elFlag = true" onblur="set_el_x(false);" onkeydown="event.keyCode == 13 ? set_el_x(true) : (window.elFlag = true)" style="width: 80px" autocomplete="off" /><input type="text" id="top" onfocus="window.elFlag = true" onblur="set_el_y(false);" onkeydown="event.keyCode == 13 ? set_el_y(true) : (window.elFlag = true)" style="float: right;width: 80px" autocomplete="off"/><span style="float: right">Y</span></dd>
            <dd><br /></dd>
            <dd style="text-align: right"><button class="copy" style="float: left" data-clipboard-target="#left">复制X</button><button class="copy" style="float: left" data-clipboard-target="#top">复制Y</button><button onclick="remove_el()">删除</button></dd>
        </dl>
        <hr />
        <dl>
            <dt>上传表格</dt>
            <dd>
                <form action="http://www.apiorder.com/tool/excel/uploadTemp" method="post" enctype="multipart/form-data" target="_excel">
                    <input type="hidden" name="excel" />
                    <input type="file" name="file" onchange="reset_excel();this.parentNode.submit()" />
                </form>
            </dd>
            <dd>
                <select id="list" multiple="multiple" style="width: 100%; height: 100px"></select>
            </dd>
            <dd style="text-align: right"><a style="float: left;" href="javascript:;" onclick="do_all()">全选</a><a style="float: left; margin-left: 10px" target="_blank" href="https://www.lodop.net/download.html">下载驱动</a><button onclick="do_print()">打印所选</button></dd>
        </dl>
    </div>
    <iframe style="display: none" name="_image" onload="upload_image_callback(this)"></iframe>
    <iframe style="display: none" name="_excel" onload="upload_excel_callback(this)"></iframe>
</body>
</html>

